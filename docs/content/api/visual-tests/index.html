---
title: "Visual Sanity Tests"
description: "Visual regression test cases for notation rendering"
---

<p>This page displays notation test cases with their rendered output to help catch visual regressions and document expected rendering behavior. Use the "Copy SVG" button to copy rendered output for updating baseline expectations.</p>

{{ $manifest := (json "visual-tests/manifest.json" "") }}
{{ $cases := $manifest.cases }}

{{ range $manifest.categories }}
<div class="visual-test-category">
  <h2>{{ .name }} ({{ len .cases }})</h2>
  <div class="visual-test-grid">
    {{ $catCases := .cases }}
    {{ range $catCases }}
    {{ $caseId := . }}
    {{ $caseMeta := index $cases $caseId }}
    {{ $inputPath := printf "static/visual-tests/cases/%s/input.txt" $caseId }}
    {{ $expectedPath := printf "static/visual-tests/cases/%s/expected.svg" $caseId }}
    {{ $input := includeFileText $inputPath }}
    {{ $expected := includeFile $expectedPath }}

    <div class="visual-test-card" id="test-{{ $caseId }}">
      <div class="visual-test-card-header">
        <div class="visual-test-card-title">{{ $caseMeta.name }}</div>
        <div class="visual-test-card-id">{{ $caseId }}</div>
      </div>
      <div class="visual-test-card-body">
        {{ if $caseMeta.description }}
        <div class="visual-test-description">{{ $caseMeta.description }}</div>
        {{ end }}

        <div class="visual-test-section">
          <div class="visual-test-label">Input</div>
          <div class="visual-test-input">{{ $input }}</div>
        </div>

        <div class="visual-test-section">
          <div class="visual-test-label">Expected</div>
          <div class="visual-test-expected" id="expected-{{ $caseId }}">
            {{ if $expected }}
            {{ $expected }}
            {{ else }}
            <span class="visual-test-expected-placeholder">No baseline saved</span>
            {{ end }}
          </div>
        </div>

        <div class="visual-test-section">
          <div class="visual-test-label-row">
            <span class="visual-test-label">Rendered</span>
            <button class="visual-test-copy-btn" data-target="output-{{ $caseId }}" title="Copy SVG to clipboard">Copy SVG</button>
          </div>
          <div class="visual-test-output" id="output-{{ $caseId }}">
            <notation id="render-{{ $caseId }}">{{ $input }}</notation>
          </div>
        </div>
      </div>
    </div>
    {{ end }}
  </div>
</div>
{{ end }}

<script>
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.visual-test-copy-btn').forEach(function(btn) {
    btn.addEventListener('click', function() {
      var targetId = btn.getAttribute('data-target');
      var container = document.getElementById(targetId);
      if (!container) return;

      var svg = container.querySelector('svg');
      if (!svg) {
        alert('No SVG found to copy');
        return;
      }

      var svgContent = svg.outerHTML;
      navigator.clipboard.writeText(svgContent).then(function() {
        var originalText = btn.textContent;
        btn.textContent = 'Copied!';
        setTimeout(function() {
          btn.textContent = originalText;
        }, 2000);
      }).catch(function(err) {
        console.error('Failed to copy:', err);
        alert('Failed to copy SVG');
      });
    });
  });
});
</script>
