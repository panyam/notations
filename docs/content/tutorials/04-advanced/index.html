---
title: "Tutorial 04: Advanced Techniques"
description: "Master complex notation patterns and advanced features"
---

<p>This tutorial covers advanced techniques for creating complex Carnatic music notation.</p>

<h2 id="nested-groups">Nested Groups</h2>

<p>Groups can contain other groups for complex rhythmic patterns:</p>

<notation id="nested-groups" showSource="true" caption="Nested Groups">
\beatDuration(4)
S [R [G M] P] D N S.
</notation>

<p>The inner group [G M] is nested within the outer group [R [G M] P], creating a subdivision.</p>

<h2 id="custom-note-durations">Custom Note Durations</h2>

<p>Combine duration prefixes with beat duration for precise control:</p>

<notation id="custom-durations" showSource="true" caption="Custom Durations">
\beatDuration(4)
S 2 R [G M] 3 P D N S.
</notation>

<p>Here, R has duration 2 and P has duration 3 at a beat duration of 4 notes per beat.</p>

<h2 id="fractional-durations">Fractional Durations</h2>

<p>Use fractions for precise duration control:</p>

<notation id="fractional" showSource="true" caption="Fractional Durations">
\beatDuration(4)
S 3/2 R G 1/2 M P D N S.
</notation>

<h2 id="multiple-roles">Multiple Roles</h2>

<p>Use multiple lines to represent different aspects of the composition:</p>

<notation id="multi-role" showSource="true" caption="Multiple Roles">
\beatDuration(4)
\role("Perc", notes=true)
Sw: S R G M P D N S.
Sh: sa ri ga ma pa dha ni sa
Perc: ta ki ta ta ta ki ta ta
</notation>

<p>The first line shows swaras, the second shows sahitya, and the third shows percussion syllables.</p>

<h2 id="complex-rhythmic-patterns">Complex Rhythmic Patterns</h2>

<p>Combine groups, spacing, and beat duration to create intricate rhythms:</p>

<notation id="complex-rhythm" showSource="true" caption="Complex Rhythm">
\beatDuration(2)
\line("First Speed")
S [R G] , [M P] D
\beatDuration(4)
\line("Second Speed")
[S R] [G M] [P D] [N S.]
\beatDuration(2)
\line("Back to First")
S.
</notation>

<h2 id="cycle-and-line-management">Cycle and Line Management</h2>

<p>Use cycle and line commands to organize longer pieces:</p>

<notation id="long-comp" showSource="true" caption="Structured Composition">
\cycle("|4|2|2|")
\beatDuration(4)
\line("Pallavi")
Sw: S R G M P D N S.
\line("Anupallavi")
Sw: S. N D P M G R S
\line("Charanam")
Sw: S R [G M] P [D N] S.
</notation>

<h2>Practice Exercise</h2>

<p>Create a complete composition using all the techniques you've learned:</p>

<notation id="final-practice" showSource="true" caption="Complete Composition">
\cycle("|4|2|2|")
\beatDuration(2)
\line("Opening")
Sw: S R G M , P D N S.
Sh: sa ri ga ma , pa dha ni sa
\beatDuration(4)
\line("Second Speed")
Sw: S R [G M] [P D] N S.
Sh: sa ri ga ma pa dha ni sa
\beatDuration(2)
\line("Closing")
Sw: S. , , S
Sh: sa , , sa
</notation>

<h2 id="model-change-events">Model Change Events</h2>

<p>The Notations library uses the Observer pattern to notify your code when the model changes. This is useful for building interactive editors, undo/redo systems, or keeping views synchronized with the model.</p>

<h3>Enabling Events</h3>

<p>First, enable events on entities you want to observe:</p>

<pre><code class="language-typescript">const group = new Group();
group.enableEvents();  // Now observers will receive notifications
</code></pre>

<h3>Observing a Group</h3>

<p>Add an observer to receive notifications when atoms are added, inserted, or removed:</p>

<pre><code class="language-typescript">import { Group, Note, GroupObserver } from 'notations';

const group = new Group();
group.enableEvents();

// Create an observer
const observer: GroupObserver = {
  onAtomsAdded: (group, atoms, index) => {
    console.log(`Added ${atoms.length} atoms at index ${index}`);
  },
  onAtomsRemoved: (group, atoms) => {
    console.log(`Removed ${atoms.length} atoms`);
  }
};

// Register and get unsubscribe function
const unsubscribe = group.addObserver(observer);

// Make changes - observer is notified
group.addAtoms(false, new Note("S"), new Note("R"));
// Output: Added 2 atoms at index 0

// Unsubscribe when done
unsubscribe();
</code></pre>

<h3>Available Observers</h3>

<ul>
  <li><strong>GroupObserver</strong> - Observe atoms in a Group (onAtomsAdded, onAtomsInserted, onAtomsRemoved)</li>
  <li><strong>RoleObserver</strong> - Observe atoms in a Role (same callbacks as GroupObserver)</li>
  <li><strong>LineObserver</strong> - Observe roles in a Line (onRoleAdded, onRoleRemoved)</li>
  <li><strong>BlockObserver</strong> - Observe items in a Block (onItemAdded, onItemRemoved)</li>
</ul>

<h3>Use Cases</h3>

<ul>
  <li><strong>Live Editing</strong> - Update the rendered view when the user makes changes</li>
  <li><strong>Undo/Redo</strong> - Record changes to build an undo stack</li>
  <li><strong>Collaboration</strong> - Sync changes with other users</li>
  <li><strong>Validation</strong> - Check constraints when the model changes</li>
</ul>

<p>Try the <a href="{{.Site.PathPrefix}}/api/playgrounds/model-events/">interactive Model Events demo</a> to see observers in action.</p>

<h2>Next Steps</h2>

<ul>
  <li><a href="{{.Site.PathPrefix}}/reference/">Reference Documentation</a> - Complete syntax specification</li>
  <li><a href="{{.Site.PathPrefix}}/examples/">Examples</a> - Real-world examples and patterns</li>
  <li><a href="{{.Site.PathPrefix}}/api/">API Documentation</a> - Use the library programmatically</li>
  <li><a href="{{.Site.PathPrefix}}/api/reference/observer-pattern/">Observer Pattern API</a> - Full observer API reference</li>
</ul>
